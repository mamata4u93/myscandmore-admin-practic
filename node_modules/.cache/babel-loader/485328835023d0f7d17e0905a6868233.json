{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _toConsumableArray from 'babel-runtime/helpers/toConsumableArray';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport React, { createElement } from 'react';\nimport PropTypes from 'prop-types';\nimport TweenOne, { ticker } from 'rc-tween-one';\nimport { polyfill } from 'react-lifecycles-compat';\nimport { toArrayChildren, findChildInChildrenByKey, windowIsUndefined, mergeChildren, transformArguments, getChildrenFromProps } from './utils';\nimport AnimTypes from './animTypes';\n\nvar noop = function noop() {};\n\nvar typeDefault = ['displayName', 'propTypes', 'getDefaultProps', 'defaultProps', 'childContextTypes', 'contextTypes', 'contextType'];\n\nvar QueueAnim = function (_React$Component) {\n  _inherits(QueueAnim, _React$Component);\n\n  _createClass(QueueAnim, null, [{\n    key: 'getDerivedStateFromProps',\n    value: function getDerivedStateFromProps(props, _ref) {\n      var prevProps = _ref.prevProps,\n          children = _ref.children,\n          prevChildShow = _ref.childrenShow,\n          $self = _ref.$self;\n      var nextState = {\n        prevProps: props\n      };\n\n      if (prevProps && props !== prevProps) {\n        var nextChildren = toArrayChildren(props.children).filter(function (c) {\n          return c;\n        });\n        var currentChildren = $self.originalChildren.filter(function (item) {\n          return item;\n        });\n\n        if (children.length) {\n          /**\n           * 多次刷新处理\n           * 如果 state.children 里还有元素，元素还在动画，当前子级加回在出场的子级;\n           */\n          var leaveChild = children.filter(function (item) {\n            return item && $self.keysToLeave.indexOf(item.key) >= 0;\n          });\n          $self.leaveUnfinishedChild = leaveChild.map(function (item) {\n            if ($self.placeholderTimeoutIds[item.key]) {\n              return item.key;\n            }\n\n            return null;\n          }).filter(function (c) {\n            return c;\n          });\n          /**\n           * 获取 leaveChild 在 state.children 里的序列，再将 leaveChild 和 currentChildren 的重新排序。\n           * 避逸 state.children 在 leaveComplete 里没全部完成不触发，\n           * leaveComplete 里如果动画完成了是会删除 keyToLeave，但 state.children 是在全部出场后才触发清除，\n           * 所以这里需要处理出场完成的元素做清除。\n           */\n\n          var stateChildren = mergeChildren(currentChildren, children);\n          var currentChild = [];\n\n          var childReOrder = function childReOrder(child) {\n            child.forEach(function (item) {\n              var order = stateChildren.findIndex(function (c) {\n                return c.key === item.key;\n              });\n\n              if (currentChild.indexOf(item) !== -1) {\n                return;\n              } // -1 不应该出现的情况，直接插入数组后面.\n\n\n              if (order === -1) {\n                currentChild.push(item);\n              } else {\n                currentChild.splice(order, 0, item);\n              }\n            });\n          };\n\n          childReOrder(leaveChild);\n          childReOrder(currentChildren);\n          currentChildren = currentChild.filter(function (c) {\n            return c;\n          });\n        }\n\n        var newChildren = mergeChildren(currentChildren, nextChildren);\n        var childrenShow = !newChildren.length ? {} : prevChildShow;\n        $self.keysToEnterPaused = {};\n        var emptyBool = !nextChildren.length && !currentChildren.length && children.length;\n        /**\n         * 在出场没结束时，childrenShow 里的值将不会清除。\n         * 再触发进场时， childrenShow 里的值是保留着的, 设置了 forcedReplay 将重新播放进场。\n         */\n\n        if (!emptyBool) {\n          // 空子级状态下刷新不做处理\n          var nextKeys = nextChildren.map(function (c) {\n            return c.key;\n          });\n          $self.keysToLeave.forEach(function (key) {\n            // 将所有在出场里的停止掉。避免间隔性出现\n            if (nextKeys.indexOf(key) >= 0) {\n              $self.keysToEnterPaused[key] = true;\n              currentChildren = currentChildren.filter(function (item) {\n                return item.key !== key;\n              });\n\n              if (props.forcedReplay) {\n                // 清掉所有出场的。\n                delete childrenShow[key];\n              }\n            }\n          });\n        }\n\n        $self.keysToEnter = [];\n        $self.keysToLeave = []; // need render to avoid update\n\n        nextState.childrenShow = childrenShow;\n        nextState.children = newChildren;\n        nextChildren.forEach(function (c) {\n          if (!c) {\n            return;\n          }\n\n          var key = c.key;\n          var hasPrev = findChildInChildrenByKey(currentChildren, key);\n\n          if (!hasPrev && key) {\n            $self.keysToEnter.push(key);\n          }\n        });\n        currentChildren.forEach(function (c) {\n          if (!c) {\n            return;\n          }\n\n          var key = c.key;\n          var hasNext = findChildInChildrenByKey(nextChildren, key);\n\n          if (!hasNext && key) {\n            $self.keysToLeave.push(key);\n            ticker.clear($self.placeholderTimeoutIds[key]);\n            delete $self.placeholderTimeoutIds[key];\n          }\n        });\n      }\n\n      return nextState;\n    }\n  }]);\n\n  function QueueAnim(props) {\n    _classCallCheck(this, QueueAnim);\n    /**\n     * @param tweenToEnter;\n     * 记录强制切换时是否需要添加 animation;\n     * 如 enter 后, leave -> enter，样式是没有发生变化，就不需要添加 animation 属性。\n     */\n\n\n    var _this = _possibleConstructorReturn(this, (QueueAnim.__proto__ || Object.getPrototypeOf(QueueAnim)).call(this, props));\n\n    _initialiseProps.call(_this);\n\n    _this.tweenToEnter = {};\n    /**\n     * @param leaveUnfinishedChild;\n     * 记录多次切换，出场没完成动画的 key。\n     */\n\n    _this.leaveUnfinishedChild = [];\n    /**\n     * @param saveTweenOneTag;\n     * 记录 TweenOne 标签，在 leaveUnfinishedChild 里使用，残留的元素不需要考虑 props 的变更。\n     */\n\n    _this.saveTweenOneTag = {};\n    /**\n     * @param childrenShow;\n     * 记录 animation 里是否需要 startAnim;\n     * 当前元素是否处在显示状态\n     * enterBegin 到 leaveComplete 之前都处于显示状态\n     */\n\n    _this.childrenShow = {};\n    /**\n     * @param keysToEnter;\n     * 记录进场的 key;\n     */\n\n    _this.keysToEnter = [];\n    /**\n     * @param keysToLeave;\n     * 记录出场的 key;\n     */\n\n    _this.keysToLeave = [];\n    /**\n     * @param keysToEnterPaused;\n     * 记录在进入时是否处理暂停状态\n     */\n\n    _this.keysToEnterPaused = {};\n    /**\n     * @param placeholderTimeoutIds;\n     * 进场时 deley 的 timeout 记录;\n     */\n\n    _this.placeholderTimeoutIds = {};\n    /**\n     * @param childRefs;\n     * 储存 children 的 ref;\n     */\n\n    _this.childRefs = {};\n    /**\n     * @param currentRef;\n     * 记录 component 是组件时的 ref;\n     */\n\n    _this.currentRef = null; // 第一次进入，默认进场\n\n    var children = toArrayChildren(getChildrenFromProps(props));\n    var childrenShow = {};\n    children.forEach(function (child) {\n      if (!child || !child.key) {\n        return;\n      }\n\n      if (_this.props.appear) {\n        _this.keysToEnter.push(child.key);\n      } else {\n        childrenShow[child.key] = true;\n        _this.tweenToEnter[child.key] = true;\n      }\n    });\n    _this.originalChildren = toArrayChildren(getChildrenFromProps(props));\n    _this.state = {\n      children: children,\n      childrenShow: childrenShow,\n      $self: _this\n    };\n    return _this;\n  }\n\n  _createClass(QueueAnim, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      if (this.props.appear) {\n        this.componentDidUpdate();\n      }\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate() {\n      this.originalChildren = toArrayChildren(getChildrenFromProps(this.props));\n      var keysToEnter = [].concat(_toConsumableArray(this.keysToEnter));\n      var keysToLeave = [].concat(_toConsumableArray(this.keysToLeave));\n      keysToEnter.forEach(this.performEnter);\n      keysToLeave.forEach(this.performLeave);\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      var _this2 = this;\n\n      Object.keys(this.placeholderTimeoutIds).forEach(function (key) {\n        ticker.clear(_this2.placeholderTimeoutIds[key]);\n      });\n      this.keysToEnter = [];\n      this.keysToLeave = [];\n      this.childrenShow = {};\n    }\n  }, {\n    key: 'getTweenType',\n    value: function getTweenType(type, num) {\n      var data = AnimTypes[type];\n      return this.getTweenAnimConfig(data, num);\n    }\n  }, {\n    key: 'getTweenAnimConfig',\n    value: function getTweenAnimConfig(data, num, enterOrLeave) {\n      var _this3 = this;\n\n      if (Array.isArray(data)) {\n        return data.map(function (item) {\n          return _this3.getTweenSingleConfig(item, num, enterOrLeave);\n        });\n      }\n\n      return this.getTweenSingleConfig(data, num, enterOrLeave);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this4 = this;\n\n      var _props = this.props,\n          component = _props.component,\n          componentProps = _props.componentProps,\n          interval = _props.interval,\n          duration = _props.duration,\n          delay = _props.delay,\n          type = _props.type,\n          animConfig = _props.animConfig,\n          ease = _props.ease,\n          leaveReverse = _props.leaveReverse,\n          animatingClassName = _props.animatingClassName,\n          forcedReplay = _props.forcedReplay,\n          onEnd = _props.onEnd,\n          appear = _props.appear,\n          tagProps = _objectWithoutProperties(_props, ['component', 'componentProps', 'interval', 'duration', 'delay', 'type', 'animConfig', 'ease', 'leaveReverse', 'animatingClassName', 'forcedReplay', 'onEnd', 'appear']);\n\n      if (windowIsUndefined) {\n        return createElement(component, _extends({}, tagProps, componentProps), this.props.children);\n      }\n\n      var childrenToRender = toArrayChildren(this.state.children).map(this.getChildrenToRender);\n\n      var props = _extends({}, tagProps, this.props.componentProps, {\n        ref: function ref(c) {\n          _this4.currentRef = c;\n        }\n      });\n\n      return createElement(this.props.component, props, childrenToRender);\n    }\n  }]);\n\n  return QueueAnim;\n}(React.Component);\n\nQueueAnim.propTypes = {\n  children: PropTypes.any,\n  component: PropTypes.any,\n  componentProps: PropTypes.object,\n  interval: PropTypes.any,\n  duration: PropTypes.any,\n  delay: PropTypes.any,\n  type: PropTypes.any,\n  animConfig: PropTypes.any,\n  ease: PropTypes.any,\n  leaveReverse: PropTypes.bool,\n  forcedReplay: PropTypes.bool,\n  animatingClassName: PropTypes.array,\n  onEnd: PropTypes.func,\n  appear: PropTypes.bool\n};\nQueueAnim.defaultProps = {\n  component: 'div',\n  componentProps: {},\n  interval: 100,\n  duration: 450,\n  delay: 0,\n  type: 'right',\n  animConfig: null,\n  ease: 'easeOutQuart',\n  leaveReverse: false,\n  forcedReplay: false,\n  animatingClassName: ['queue-anim-entering', 'queue-anim-leaving'],\n  onEnd: noop,\n  appear: true\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this5 = this;\n\n  this.getTweenSingleConfig = function (data, num, enterOrLeave) {\n    var obj = {};\n    Object.keys(data).forEach(function (key) {\n      if (Array.isArray(data[key])) {\n        obj[key] = data[key][num];\n      } else if (!enterOrLeave && !num || enterOrLeave && num) {\n        obj[key] = data[key];\n      }\n    });\n    return obj;\n  };\n\n  this.getTweenData = function (key, i, type) {\n    var props = _this5.props;\n    var enterOrLeave = type === 'enter' ? 0 : 1;\n    var start = type === 'enter' ? 1 : 0;\n    var end = type === 'enter' ? 0 : 1;\n\n    var animate = _this5.getAnimData(props, key, i, enterOrLeave, end);\n\n    var startAnim = type === 'enter' && (props.forcedReplay || !_this5.childrenShow[key]) ? _this5.getAnimData(props, key, i, enterOrLeave, start) : null;\n    var ease = transformArguments(props.ease, key, i)[enterOrLeave];\n    var duration = transformArguments(props.duration, key, i)[enterOrLeave];\n\n    if (Array.isArray(ease)) {\n      ease = ease.map(function (num) {\n        return num * 100;\n      });\n      ease = TweenOne.easing.path('M0,100C' + ease[0] + ',' + (100 - ease[1]) + ',' + ease[2] + ',' + (100 - ease[3]) + ',100,0', {\n        lengthPixel: duration / 16.6667\n      });\n    }\n\n    return {\n      startAnim: startAnim,\n      animate: animate,\n      ease: ease,\n      duration: duration,\n      isArray: Array.isArray(animate)\n    };\n  };\n\n  this.getTweenSingleData = function (startAnim, animate, ease, duration, delay, onStart, onComplete) {\n    var startLength = Object.keys(startAnim || {}).length;\n\n    var animation = _extends({\n      onStart: onStart,\n      onComplete: onComplete,\n      duration: duration,\n      delay: delay,\n      ease: ease\n    }, animate);\n\n    var startAnimate = startLength ? _extends({\n      duration: 0\n    }, startAnim) : null;\n    return {\n      animation: animation,\n      startAnimate: startAnimate\n    };\n  };\n\n  this.getTweenEnterOrLeaveData = function (key, i, delay, type) {\n    var animateData = _this5.getTweenData(key, i, type);\n\n    var startAnim = animateData.startAnim;\n    var animate = animateData.animate;\n    var onStart = (type === 'enter' ? _this5.enterBegin : _this5.leaveBegin).bind(_this5, key);\n    var onComplete = (type === 'enter' ? _this5.enterComplete : _this5.leaveComplete).bind(_this5, key);\n\n    if (animateData.isArray) {\n      var length = animate.length - 1;\n      var animation = [];\n      var startArray = [];\n      animate.forEach(function (leave, ii) {\n        var start = startAnim && startAnim[ii];\n\n        var animObj = _this5.getTweenSingleData(start, leave, animateData.ease, animateData.duration / length, !ii ? delay : 0, !ii ? onStart : null, ii === length ? onComplete : null);\n\n        animation.push(animObj.animation);\n\n        if (animObj.startAnimate) {\n          startArray.push(animObj.startAnimate);\n        }\n      });\n      return startArray.concat(animation);\n    }\n\n    animateData = _this5.getTweenSingleData(startAnim, animate, animateData.ease, animateData.duration, delay, onStart, onComplete);\n    return [animateData.startAnimate, animateData.animation].filter(function (item) {\n      return item;\n    });\n  };\n\n  this.getAnimData = function (props, key, i, enterOrLeave, startOrEnd) {\n    /**\n     * transformArguments 第一个为 enter, 第二个为 leave；\n     * getTweenAnimConfig or getTweenType 第一个为到达的位置， 第二个为开始的位置。\n     * 用 tween-one 的数组来实现老的动画逻辑。。。\n     */\n    return props.animConfig ? _this5.getTweenAnimConfig(transformArguments(props.animConfig, key, i)[enterOrLeave], startOrEnd, enterOrLeave) : _this5.getTweenType(transformArguments(props.type, key, i)[enterOrLeave], startOrEnd);\n  };\n\n  this.getChildrenToRender = function (child) {\n    var _props2 = _this5.props,\n        forcedReplay = _props2.forcedReplay,\n        leaveReverse = _props2.leaveReverse,\n        delay = _props2.delay,\n        interval = _props2.interval,\n        children = _props2.children;\n\n    if (!child || !child.key) {\n      return child;\n    }\n\n    var key = child.key;\n\n    if (!_this5.state.childrenShow[key]) {\n      return null;\n    }\n\n    var i = _this5.keysToLeave.indexOf(key);\n\n    var animation = void 0;\n    var isFunc = typeof child.type === 'function';\n    var forcedJudg = isFunc ? {} : null;\n\n    if (isFunc) {\n      Object.keys(child.type).forEach(function (name) {\n        if (typeDefault.indexOf(name) === -1) {\n          forcedJudg[name] = child.type[name];\n        }\n      });\n    }\n\n    var ref = function ref() {\n      delete _this5.childRefs[key];\n    }; // 处理出场\n\n\n    if (i >= 0) {\n      if (_this5.leaveUnfinishedChild.indexOf(key) >= 0) {\n        return _this5.saveTweenOneTag[key];\n      }\n\n      var $interval = transformArguments(interval, key, i)[1];\n      var $delay = transformArguments(delay, key, i)[1]; // 减掉 leaveUnfinishedChild 里的个数，因为 leaveUnfinishedChild 是旧的出场，不应该计录在队列里。\n\n      var order = (leaveReverse ? _this5.keysToLeave.length - i - 1 : i) - _this5.leaveUnfinishedChild.length;\n      $delay = $interval * order + $delay;\n      animation = _this5.getTweenEnterOrLeaveData(key, i, $delay, 'leave');\n    } else {\n      // 处理进场;\n      i = toArrayChildren(children).findIndex(function (c) {\n        return c && c.key === key;\n      });\n\n      ref = function ref(c) {\n        _this5.childRefs[key] = c && c.currentRef ? c.currentRef : c;\n      }; // appear=\bfalse 时，设定 childrenShow 和 tweenToEnter 都为 true, 这里不渲染 animation;\n\n\n      if (_this5.tweenToEnter[key] && !forcedReplay) {\n        // 如果是已进入的，将直接返回标签。。\n        return createElement(TweenOne, {\n          key: key,\n          component: child.type,\n          forcedJudg: forcedJudg,\n          componentProps: child.props,\n          ref: ref\n        });\n      }\n\n      if (!_this5.tweenToEnter[key] || forcedReplay) {\n        animation = _this5.getTweenEnterOrLeaveData(key, i, 0, 'enter');\n      }\n    }\n\n    var paused = _this5.keysToEnterPaused[key] && _this5.keysToLeave.indexOf(key) === -1;\n    animation = paused ? null : animation;\n    var tag = createElement(TweenOne, {\n      key: key,\n      component: child.type,\n      forcedJudg: forcedJudg,\n      componentProps: child.props,\n      animation: animation,\n      ref: ref\n    });\n    _this5.saveTweenOneTag[key] = tag;\n    return tag;\n  };\n\n  this.performEnter = function (key, i) {\n    var interval = transformArguments(_this5.props.interval, key, i)[0];\n    var delay = transformArguments(_this5.props.delay, key, i)[0];\n    _this5.placeholderTimeoutIds[key] = ticker.timeout(_this5.performEnterBegin.bind(_this5, key), interval * i + delay);\n\n    if (_this5.keysToEnter.indexOf(key) >= 0) {\n      _this5.keysToEnter.splice(_this5.keysToEnter.indexOf(key), 1);\n    }\n  };\n\n  this.performEnterBegin = function (key) {\n    var childrenShow = _this5.state.childrenShow;\n    childrenShow[key] = true;\n    delete _this5.keysToEnterPaused[key];\n    ticker.clear(_this5.placeholderTimeoutIds[key]);\n    delete _this5.placeholderTimeoutIds[key];\n\n    _this5.setState({\n      childrenShow: childrenShow\n    });\n  };\n\n  this.performLeave = function (key) {\n    ticker.clear(_this5.placeholderTimeoutIds[key]);\n    delete _this5.placeholderTimeoutIds[key];\n  };\n\n  this.enterBegin = function (key, e) {\n    var elem = e.target;\n    var animatingClassName = _this5.props.animatingClassName;\n    elem.className = elem.className.replace(animatingClassName[1], '');\n\n    if (elem.className.indexOf(animatingClassName[0]) === -1) {\n      elem.className = (elem.className + ' ' + animatingClassName[0]).trim();\n    }\n\n    _this5.childrenShow[key] = true;\n  };\n\n  this.enterComplete = function (key, e) {\n    if (_this5.keysToEnterPaused[key] || _this5.keysToLeave.indexOf(key) >= 0) {\n      return;\n    }\n\n    var elem = e.target;\n    elem.className = elem.className.replace(_this5.props.animatingClassName[0], '').trim();\n    _this5.tweenToEnter[key] = true;\n\n    _this5.props.onEnd({\n      key: key,\n      type: 'enter',\n      target: elem\n    });\n  };\n\n  this.leaveBegin = function (key, e) {\n    var elem = e.target;\n    var animatingClassName = _this5.props.animatingClassName;\n    elem.className = elem.className.replace(animatingClassName[0], '');\n\n    if (elem.className.indexOf(animatingClassName[1]) === -1) {\n      elem.className = (elem.className + ' ' + animatingClassName[1]).trim();\n    }\n\n    delete _this5.tweenToEnter[key];\n  };\n\n  this.leaveComplete = function (key, e) {\n    // 切换时同时触发 onComplete。 手动跳出。。。\n    if (toArrayChildren(_this5.props.children).findIndex(function (c) {\n      return c && c.key === key;\n    }) >= 0) {\n      return;\n    }\n\n    var childrenShow = _this5.state.childrenShow;\n    delete childrenShow[key];\n    delete _this5.saveTweenOneTag[key];\n    delete _this5.childrenShow[key];\n\n    if (_this5.keysToLeave.indexOf(key) >= 0) {\n      _this5.keysToLeave.splice(_this5.keysToLeave.indexOf(key), 1);\n    }\n\n    var needLeave = _this5.keysToLeave.some(function (c) {\n      return childrenShow[c];\n    });\n\n    if (!needLeave) {\n      var currentChildren = toArrayChildren(getChildrenFromProps(_this5.props));\n\n      _this5.setState({\n        children: currentChildren,\n        childrenShow: childrenShow\n      });\n    }\n\n    var elem = e.target;\n    elem.className = elem.className.replace(_this5.props.animatingClassName[1], '').trim();\n\n    _this5.props.onEnd({\n      key: key,\n      type: 'leave',\n      target: elem\n    });\n  };\n};\n\nQueueAnim.isQueueAnim = true;\nexport default polyfill(QueueAnim);","map":{"version":3,"names":["_extends","_objectWithoutProperties","_toConsumableArray","_classCallCheck","_possibleConstructorReturn","_createClass","_inherits","React","createElement","PropTypes","TweenOne","ticker","polyfill","toArrayChildren","findChildInChildrenByKey","windowIsUndefined","mergeChildren","transformArguments","getChildrenFromProps","AnimTypes","noop","typeDefault","QueueAnim","_React$Component","key","value","getDerivedStateFromProps","props","_ref","prevProps","children","prevChildShow","childrenShow","$self","nextState","nextChildren","filter","c","currentChildren","originalChildren","item","length","leaveChild","keysToLeave","indexOf","leaveUnfinishedChild","map","placeholderTimeoutIds","stateChildren","currentChild","childReOrder","child","forEach","order","findIndex","push","splice","newChildren","keysToEnterPaused","emptyBool","nextKeys","forcedReplay","keysToEnter","hasPrev","hasNext","clear","_this","__proto__","Object","getPrototypeOf","call","_initialiseProps","tweenToEnter","saveTweenOneTag","childRefs","currentRef","appear","state","componentDidMount","componentDidUpdate","concat","performEnter","performLeave","componentWillUnmount","_this2","keys","getTweenType","type","num","data","getTweenAnimConfig","enterOrLeave","_this3","Array","isArray","getTweenSingleConfig","render","_this4","_props","component","componentProps","interval","duration","delay","animConfig","ease","leaveReverse","animatingClassName","onEnd","tagProps","childrenToRender","getChildrenToRender","ref","Component","propTypes","any","object","bool","array","func","defaultProps","_this5","obj","getTweenData","i","start","end","animate","getAnimData","startAnim","easing","path","lengthPixel","getTweenSingleData","onStart","onComplete","startLength","animation","startAnimate","getTweenEnterOrLeaveData","animateData","enterBegin","leaveBegin","bind","enterComplete","leaveComplete","startArray","leave","ii","animObj","startOrEnd","_props2","isFunc","forcedJudg","name","$interval","$delay","paused","tag","timeout","performEnterBegin","setState","e","elem","target","className","replace","trim","needLeave","some","isQueueAnim"],"sources":["/Users/sunita/Sites/Erptech/myscandmore-admin-practic/node_modules/rc-queue-anim/es/QueueAnim.js"],"sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _toConsumableArray from 'babel-runtime/helpers/toConsumableArray';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport React, { createElement } from 'react';\nimport PropTypes from 'prop-types';\nimport TweenOne, { ticker } from 'rc-tween-one';\nimport { polyfill } from 'react-lifecycles-compat';\n\nimport { toArrayChildren, findChildInChildrenByKey, windowIsUndefined, mergeChildren, transformArguments, getChildrenFromProps } from './utils';\nimport AnimTypes from './animTypes';\n\nvar noop = function noop() {};\n\nvar typeDefault = ['displayName', 'propTypes', 'getDefaultProps', 'defaultProps', 'childContextTypes', 'contextTypes', 'contextType'];\n\nvar QueueAnim = function (_React$Component) {\n  _inherits(QueueAnim, _React$Component);\n\n  _createClass(QueueAnim, null, [{\n    key: 'getDerivedStateFromProps',\n    value: function getDerivedStateFromProps(props, _ref) {\n      var prevProps = _ref.prevProps,\n          children = _ref.children,\n          prevChildShow = _ref.childrenShow,\n          $self = _ref.$self;\n\n      var nextState = {\n        prevProps: props\n      };\n      if (prevProps && props !== prevProps) {\n        var nextChildren = toArrayChildren(props.children).filter(function (c) {\n          return c;\n        });\n        var currentChildren = $self.originalChildren.filter(function (item) {\n          return item;\n        });\n        if (children.length) {\n          /**\n           * 多次刷新处理\n           * 如果 state.children 里还有元素，元素还在动画，当前子级加回在出场的子级;\n           */\n          var leaveChild = children.filter(function (item) {\n            return item && $self.keysToLeave.indexOf(item.key) >= 0;\n          });\n          $self.leaveUnfinishedChild = leaveChild.map(function (item) {\n            if ($self.placeholderTimeoutIds[item.key]) {\n              return item.key;\n            }\n            return null;\n          }).filter(function (c) {\n            return c;\n          });\n          /**\n           * 获取 leaveChild 在 state.children 里的序列，再将 leaveChild 和 currentChildren 的重新排序。\n           * 避逸 state.children 在 leaveComplete 里没全部完成不触发，\n           * leaveComplete 里如果动画完成了是会删除 keyToLeave，但 state.children 是在全部出场后才触发清除，\n           * 所以这里需要处理出场完成的元素做清除。\n           */\n          var stateChildren = mergeChildren(currentChildren, children);\n          var currentChild = [];\n          var childReOrder = function childReOrder(child) {\n            child.forEach(function (item) {\n              var order = stateChildren.findIndex(function (c) {\n                return c.key === item.key;\n              });\n              if (currentChild.indexOf(item) !== -1) {\n                return;\n              }\n              // -1 不应该出现的情况，直接插入数组后面.\n              if (order === -1) {\n                currentChild.push(item);\n              } else {\n                currentChild.splice(order, 0, item);\n              }\n            });\n          };\n          childReOrder(leaveChild);\n          childReOrder(currentChildren);\n          currentChildren = currentChild.filter(function (c) {\n            return c;\n          });\n        }\n        var newChildren = mergeChildren(currentChildren, nextChildren);\n        var childrenShow = !newChildren.length ? {} : prevChildShow;\n        $self.keysToEnterPaused = {};\n        var emptyBool = !nextChildren.length && !currentChildren.length && children.length;\n        /**\n         * 在出场没结束时，childrenShow 里的值将不会清除。\n         * 再触发进场时， childrenShow 里的值是保留着的, 设置了 forcedReplay 将重新播放进场。\n         */\n        if (!emptyBool) {\n          // 空子级状态下刷新不做处理\n          var nextKeys = nextChildren.map(function (c) {\n            return c.key;\n          });\n          $self.keysToLeave.forEach(function (key) {\n            // 将所有在出场里的停止掉。避免间隔性出现\n            if (nextKeys.indexOf(key) >= 0) {\n              $self.keysToEnterPaused[key] = true;\n              currentChildren = currentChildren.filter(function (item) {\n                return item.key !== key;\n              });\n              if (props.forcedReplay) {\n                // 清掉所有出场的。\n                delete childrenShow[key];\n              }\n            }\n          });\n        }\n\n        $self.keysToEnter = [];\n        $self.keysToLeave = [];\n\n        // need render to avoid update\n        nextState.childrenShow = childrenShow;\n        nextState.children = newChildren;\n\n        nextChildren.forEach(function (c) {\n          if (!c) {\n            return;\n          }\n          var key = c.key;\n          var hasPrev = findChildInChildrenByKey(currentChildren, key);\n          if (!hasPrev && key) {\n            $self.keysToEnter.push(key);\n          }\n        });\n\n        currentChildren.forEach(function (c) {\n          if (!c) {\n            return;\n          }\n          var key = c.key;\n          var hasNext = findChildInChildrenByKey(nextChildren, key);\n          if (!hasNext && key) {\n            $self.keysToLeave.push(key);\n            ticker.clear($self.placeholderTimeoutIds[key]);\n            delete $self.placeholderTimeoutIds[key];\n          }\n        });\n      }\n      return nextState;\n    }\n  }]);\n\n  function QueueAnim(props) {\n    _classCallCheck(this, QueueAnim);\n\n    /**\n     * @param tweenToEnter;\n     * 记录强制切换时是否需要添加 animation;\n     * 如 enter 后, leave -> enter，样式是没有发生变化，就不需要添加 animation 属性。\n     */\n    var _this = _possibleConstructorReturn(this, (QueueAnim.__proto__ || Object.getPrototypeOf(QueueAnim)).call(this, props));\n\n    _initialiseProps.call(_this);\n\n    _this.tweenToEnter = {};\n    /**\n     * @param leaveUnfinishedChild;\n     * 记录多次切换，出场没完成动画的 key。\n     */\n    _this.leaveUnfinishedChild = [];\n    /**\n     * @param saveTweenOneTag;\n     * 记录 TweenOne 标签，在 leaveUnfinishedChild 里使用，残留的元素不需要考虑 props 的变更。\n     */\n    _this.saveTweenOneTag = {};\n    /**\n     * @param childrenShow;\n     * 记录 animation 里是否需要 startAnim;\n     * 当前元素是否处在显示状态\n     * enterBegin 到 leaveComplete 之前都处于显示状态\n     */\n    _this.childrenShow = {};\n    /**\n     * @param keysToEnter;\n     * 记录进场的 key;\n     */\n    _this.keysToEnter = [];\n    /**\n     * @param keysToLeave;\n     * 记录出场的 key;\n     */\n    _this.keysToLeave = [];\n    /**\n     * @param keysToEnterPaused;\n     * 记录在进入时是否处理暂停状态\n     */\n    _this.keysToEnterPaused = {};\n    /**\n     * @param placeholderTimeoutIds;\n     * 进场时 deley 的 timeout 记录;\n     */\n    _this.placeholderTimeoutIds = {};\n    /**\n     * @param childRefs;\n     * 储存 children 的 ref;\n     */\n    _this.childRefs = {};\n    /**\n     * @param currentRef;\n     * 记录 component 是组件时的 ref;\n     */\n    _this.currentRef = null;\n    // 第一次进入，默认进场\n    var children = toArrayChildren(getChildrenFromProps(props));\n    var childrenShow = {};\n    children.forEach(function (child) {\n      if (!child || !child.key) {\n        return;\n      }\n      if (_this.props.appear) {\n        _this.keysToEnter.push(child.key);\n      } else {\n        childrenShow[child.key] = true;\n        _this.tweenToEnter[child.key] = true;\n      }\n    });\n    _this.originalChildren = toArrayChildren(getChildrenFromProps(props));\n    _this.state = {\n      children: children,\n      childrenShow: childrenShow,\n      $self: _this\n    };\n    return _this;\n  }\n\n  _createClass(QueueAnim, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      if (this.props.appear) {\n        this.componentDidUpdate();\n      }\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate() {\n      this.originalChildren = toArrayChildren(getChildrenFromProps(this.props));\n      var keysToEnter = [].concat(_toConsumableArray(this.keysToEnter));\n      var keysToLeave = [].concat(_toConsumableArray(this.keysToLeave));\n      keysToEnter.forEach(this.performEnter);\n      keysToLeave.forEach(this.performLeave);\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      var _this2 = this;\n\n      Object.keys(this.placeholderTimeoutIds).forEach(function (key) {\n        ticker.clear(_this2.placeholderTimeoutIds[key]);\n      });\n      this.keysToEnter = [];\n      this.keysToLeave = [];\n      this.childrenShow = {};\n    }\n  }, {\n    key: 'getTweenType',\n    value: function getTweenType(type, num) {\n      var data = AnimTypes[type];\n      return this.getTweenAnimConfig(data, num);\n    }\n  }, {\n    key: 'getTweenAnimConfig',\n    value: function getTweenAnimConfig(data, num, enterOrLeave) {\n      var _this3 = this;\n\n      if (Array.isArray(data)) {\n        return data.map(function (item) {\n          return _this3.getTweenSingleConfig(item, num, enterOrLeave);\n        });\n      }\n      return this.getTweenSingleConfig(data, num, enterOrLeave);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this4 = this;\n\n      var _props = this.props,\n          component = _props.component,\n          componentProps = _props.componentProps,\n          interval = _props.interval,\n          duration = _props.duration,\n          delay = _props.delay,\n          type = _props.type,\n          animConfig = _props.animConfig,\n          ease = _props.ease,\n          leaveReverse = _props.leaveReverse,\n          animatingClassName = _props.animatingClassName,\n          forcedReplay = _props.forcedReplay,\n          onEnd = _props.onEnd,\n          appear = _props.appear,\n          tagProps = _objectWithoutProperties(_props, ['component', 'componentProps', 'interval', 'duration', 'delay', 'type', 'animConfig', 'ease', 'leaveReverse', 'animatingClassName', 'forcedReplay', 'onEnd', 'appear']);\n\n      if (windowIsUndefined) {\n        return createElement(component, _extends({}, tagProps, componentProps), this.props.children);\n      }\n      var childrenToRender = toArrayChildren(this.state.children).map(this.getChildrenToRender);\n      var props = _extends({}, tagProps, this.props.componentProps, {\n        ref: function ref(c) {\n          _this4.currentRef = c;\n        }\n      });\n      return createElement(this.props.component, props, childrenToRender);\n    }\n  }]);\n\n  return QueueAnim;\n}(React.Component);\n\nQueueAnim.propTypes = {\n  children: PropTypes.any,\n  component: PropTypes.any,\n  componentProps: PropTypes.object,\n  interval: PropTypes.any,\n  duration: PropTypes.any,\n  delay: PropTypes.any,\n  type: PropTypes.any,\n  animConfig: PropTypes.any,\n  ease: PropTypes.any,\n  leaveReverse: PropTypes.bool,\n  forcedReplay: PropTypes.bool,\n  animatingClassName: PropTypes.array,\n  onEnd: PropTypes.func,\n  appear: PropTypes.bool\n};\nQueueAnim.defaultProps = {\n  component: 'div',\n  componentProps: {},\n  interval: 100,\n  duration: 450,\n  delay: 0,\n  type: 'right',\n  animConfig: null,\n  ease: 'easeOutQuart',\n  leaveReverse: false,\n  forcedReplay: false,\n  animatingClassName: ['queue-anim-entering', 'queue-anim-leaving'],\n  onEnd: noop,\n  appear: true\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this5 = this;\n\n  this.getTweenSingleConfig = function (data, num, enterOrLeave) {\n    var obj = {};\n    Object.keys(data).forEach(function (key) {\n      if (Array.isArray(data[key])) {\n        obj[key] = data[key][num];\n      } else if (!enterOrLeave && !num || enterOrLeave && num) {\n        obj[key] = data[key];\n      }\n    });\n    return obj;\n  };\n\n  this.getTweenData = function (key, i, type) {\n    var props = _this5.props;\n    var enterOrLeave = type === 'enter' ? 0 : 1;\n    var start = type === 'enter' ? 1 : 0;\n    var end = type === 'enter' ? 0 : 1;\n    var animate = _this5.getAnimData(props, key, i, enterOrLeave, end);\n    var startAnim = type === 'enter' && (props.forcedReplay || !_this5.childrenShow[key]) ? _this5.getAnimData(props, key, i, enterOrLeave, start) : null;\n    var ease = transformArguments(props.ease, key, i)[enterOrLeave];\n    var duration = transformArguments(props.duration, key, i)[enterOrLeave];\n    if (Array.isArray(ease)) {\n      ease = ease.map(function (num) {\n        return num * 100;\n      });\n      ease = TweenOne.easing.path('M0,100C' + ease[0] + ',' + (100 - ease[1]) + ',' + ease[2] + ',' + (100 - ease[3]) + ',100,0', { lengthPixel: duration / 16.6667 });\n    }\n    return { startAnim: startAnim, animate: animate, ease: ease, duration: duration, isArray: Array.isArray(animate) };\n  };\n\n  this.getTweenSingleData = function (startAnim, animate, ease, duration, delay, onStart, onComplete) {\n    var startLength = Object.keys(startAnim || {}).length;\n    var animation = _extends({\n      onStart: onStart,\n      onComplete: onComplete,\n      duration: duration,\n      delay: delay,\n      ease: ease\n    }, animate);\n    var startAnimate = startLength ? _extends({ duration: 0 }, startAnim) : null;\n    return { animation: animation, startAnimate: startAnimate };\n  };\n\n  this.getTweenEnterOrLeaveData = function (key, i, delay, type) {\n    var animateData = _this5.getTweenData(key, i, type);\n    var startAnim = animateData.startAnim;\n    var animate = animateData.animate;\n    var onStart = (type === 'enter' ? _this5.enterBegin : _this5.leaveBegin).bind(_this5, key);\n    var onComplete = (type === 'enter' ? _this5.enterComplete : _this5.leaveComplete).bind(_this5, key);\n    if (animateData.isArray) {\n      var length = animate.length - 1;\n      var animation = [];\n      var startArray = [];\n      animate.forEach(function (leave, ii) {\n        var start = startAnim && startAnim[ii];\n        var animObj = _this5.getTweenSingleData(start, leave, animateData.ease, animateData.duration / length, !ii ? delay : 0, !ii ? onStart : null, ii === length ? onComplete : null);\n        animation.push(animObj.animation);\n        if (animObj.startAnimate) {\n          startArray.push(animObj.startAnimate);\n        }\n      });\n      return startArray.concat(animation);\n    }\n    animateData = _this5.getTweenSingleData(startAnim, animate, animateData.ease, animateData.duration, delay, onStart, onComplete);\n    return [animateData.startAnimate, animateData.animation].filter(function (item) {\n      return item;\n    });\n  };\n\n  this.getAnimData = function (props, key, i, enterOrLeave, startOrEnd) {\n    /**\n     * transformArguments 第一个为 enter, 第二个为 leave；\n     * getTweenAnimConfig or getTweenType 第一个为到达的位置， 第二个为开始的位置。\n     * 用 tween-one 的数组来实现老的动画逻辑。。。\n     */\n    return props.animConfig ? _this5.getTweenAnimConfig(transformArguments(props.animConfig, key, i)[enterOrLeave], startOrEnd, enterOrLeave) : _this5.getTweenType(transformArguments(props.type, key, i)[enterOrLeave], startOrEnd);\n  };\n\n  this.getChildrenToRender = function (child) {\n    var _props2 = _this5.props,\n        forcedReplay = _props2.forcedReplay,\n        leaveReverse = _props2.leaveReverse,\n        delay = _props2.delay,\n        interval = _props2.interval,\n        children = _props2.children;\n\n    if (!child || !child.key) {\n      return child;\n    }\n    var key = child.key;\n    if (!_this5.state.childrenShow[key]) {\n      return null;\n    }\n    var i = _this5.keysToLeave.indexOf(key);\n    var animation = void 0;\n    var isFunc = typeof child.type === 'function';\n    var forcedJudg = isFunc ? {} : null;\n    if (isFunc) {\n      Object.keys(child.type).forEach(function (name) {\n        if (typeDefault.indexOf(name) === -1) {\n          forcedJudg[name] = child.type[name];\n        }\n      });\n    }\n    var ref = function ref() {\n      delete _this5.childRefs[key];\n    };\n    // 处理出场\n    if (i >= 0) {\n      if (_this5.leaveUnfinishedChild.indexOf(key) >= 0) {\n        return _this5.saveTweenOneTag[key];\n      }\n      var $interval = transformArguments(interval, key, i)[1];\n      var $delay = transformArguments(delay, key, i)[1];\n      // 减掉 leaveUnfinishedChild 里的个数，因为 leaveUnfinishedChild 是旧的出场，不应该计录在队列里。\n      var order = (leaveReverse ? _this5.keysToLeave.length - i - 1 : i) - _this5.leaveUnfinishedChild.length;\n      $delay = $interval * order + $delay;\n      animation = _this5.getTweenEnterOrLeaveData(key, i, $delay, 'leave');\n    } else {\n      // 处理进场;\n      i = toArrayChildren(children).findIndex(function (c) {\n        return c && c.key === key;\n      });\n      ref = function ref(c) {\n        _this5.childRefs[key] = c && c.currentRef ? c.currentRef : c;\n      };\n      // appear=\bfalse 时，设定 childrenShow 和 tweenToEnter 都为 true, 这里不渲染 animation;\n      if (_this5.tweenToEnter[key] && !forcedReplay) {\n        // 如果是已进入的，将直接返回标签。。\n        return createElement(TweenOne, {\n          key: key,\n          component: child.type,\n          forcedJudg: forcedJudg,\n          componentProps: child.props,\n          ref: ref\n        });\n      }\n      if (!_this5.tweenToEnter[key] || forcedReplay) {\n        animation = _this5.getTweenEnterOrLeaveData(key, i, 0, 'enter');\n      }\n    }\n    var paused = _this5.keysToEnterPaused[key] && _this5.keysToLeave.indexOf(key) === -1;\n    animation = paused ? null : animation;\n    var tag = createElement(TweenOne, {\n      key: key,\n      component: child.type,\n      forcedJudg: forcedJudg,\n      componentProps: child.props,\n      animation: animation,\n      ref: ref\n    });\n    _this5.saveTweenOneTag[key] = tag;\n    return tag;\n  };\n\n  this.performEnter = function (key, i) {\n    var interval = transformArguments(_this5.props.interval, key, i)[0];\n    var delay = transformArguments(_this5.props.delay, key, i)[0];\n    _this5.placeholderTimeoutIds[key] = ticker.timeout(_this5.performEnterBegin.bind(_this5, key), interval * i + delay);\n    if (_this5.keysToEnter.indexOf(key) >= 0) {\n      _this5.keysToEnter.splice(_this5.keysToEnter.indexOf(key), 1);\n    }\n  };\n\n  this.performEnterBegin = function (key) {\n    var childrenShow = _this5.state.childrenShow;\n    childrenShow[key] = true;\n    delete _this5.keysToEnterPaused[key];\n    ticker.clear(_this5.placeholderTimeoutIds[key]);\n    delete _this5.placeholderTimeoutIds[key];\n    _this5.setState({ childrenShow: childrenShow });\n  };\n\n  this.performLeave = function (key) {\n    ticker.clear(_this5.placeholderTimeoutIds[key]);\n    delete _this5.placeholderTimeoutIds[key];\n  };\n\n  this.enterBegin = function (key, e) {\n    var elem = e.target;\n    var animatingClassName = _this5.props.animatingClassName;\n    elem.className = elem.className.replace(animatingClassName[1], '');\n    if (elem.className.indexOf(animatingClassName[0]) === -1) {\n      elem.className = (elem.className + ' ' + animatingClassName[0]).trim();\n    }\n    _this5.childrenShow[key] = true;\n  };\n\n  this.enterComplete = function (key, e) {\n    if (_this5.keysToEnterPaused[key] || _this5.keysToLeave.indexOf(key) >= 0) {\n      return;\n    }\n    var elem = e.target;\n    elem.className = elem.className.replace(_this5.props.animatingClassName[0], '').trim();\n    _this5.tweenToEnter[key] = true;\n    _this5.props.onEnd({ key: key, type: 'enter', target: elem });\n  };\n\n  this.leaveBegin = function (key, e) {\n    var elem = e.target;\n    var animatingClassName = _this5.props.animatingClassName;\n    elem.className = elem.className.replace(animatingClassName[0], '');\n    if (elem.className.indexOf(animatingClassName[1]) === -1) {\n      elem.className = (elem.className + ' ' + animatingClassName[1]).trim();\n    }\n    delete _this5.tweenToEnter[key];\n  };\n\n  this.leaveComplete = function (key, e) {\n    // 切换时同时触发 onComplete。 手动跳出。。。\n    if (toArrayChildren(_this5.props.children).findIndex(function (c) {\n      return c && c.key === key;\n    }) >= 0) {\n      return;\n    }\n    var childrenShow = _this5.state.childrenShow;\n    delete childrenShow[key];\n    delete _this5.saveTweenOneTag[key];\n    delete _this5.childrenShow[key];\n    if (_this5.keysToLeave.indexOf(key) >= 0) {\n      _this5.keysToLeave.splice(_this5.keysToLeave.indexOf(key), 1);\n    }\n    var needLeave = _this5.keysToLeave.some(function (c) {\n      return childrenShow[c];\n    });\n    if (!needLeave) {\n      var currentChildren = toArrayChildren(getChildrenFromProps(_this5.props));\n      _this5.setState({\n        children: currentChildren,\n        childrenShow: childrenShow\n      });\n    }\n    var elem = e.target;\n    elem.className = elem.className.replace(_this5.props.animatingClassName[1], '').trim();\n    _this5.props.onEnd({ key: key, type: 'leave', target: elem });\n  };\n};\n\nQueueAnim.isQueueAnim = true;\nexport default polyfill(QueueAnim);"],"mappings":"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"},"metadata":{},"sourceType":"module"}